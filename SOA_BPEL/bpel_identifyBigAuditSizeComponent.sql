
-- get All table size
SELECT owner, table_name, ROUND((num_rows*avg_row_len)/(1024*1024)) MB 
FROM all_tables 
WHERE owner NOT LIKE 'SYS%'  -- Exclude system tables.
AND num_rows > 0  -- Ignore empty Tables.
ORDER BY MB DESC -- Biggest first.
;

-- Results (Audit Trail = 245GB) : 
--IS_SOAINFRA	WLI_QS_REPORT_DATA	320588
--SOAUSER	AUDIT_TRAIL	245173
--SOAUSER	XML_DOCUMENT	161107
--IS_SOAINFRA	WLI_QS_REPORT_ATTRIBUTE	140281
--SOAUSER	HEADERS_PROPERTIES	136262
--SOAUSER	REFERENCE_INSTANCE	104372
--SOAUSER	DLV_SUBSCRIPTION	51050
--SOAUSER	DLV_MESSAGE	42703

--Block Size audit trail per bpel compONent
SELECT SUM(aut.block_csize) COMPRESSED_AUDIT_TRAIL_SIZE,  cui.COMPONENT_NAME
FROM SOAUSER.audit_trail aut
INNER JOIN SOAUSER.cube_instance cui ON aut.cikey = cui.cikey
GROUP BY cui.COMPONENT_NAME
ORDER BY SUM(aut.block_csize) DESC
;

--408568203012,00	BPEL1
--275750287321,00	BPEL2
--58818248746,00	BPEL3
--54621871242,00	BPEL4
--15768799964,00	BPEL5
--15153410626,00	BPEL6
--9737116018,00		BPEL7
--9147260970,00		BPEL8
--4508408426,00		BPEL9


--Block size audit trail per bpel compONent last 2 days
SELECT SUM(aut.block_csize) COMPRESSED_AUDIT_TRAIL_SIZE,  cui.COMPONENT_NAME
FROM SOAUSER.audit_trail aut
INNER JOIN SOAUSER.cube_instance cui ON aut.cikey = cui.cikey
WHERE cui.CREATION_DATE >= trunc(sysdate)-2
GROUP BY cui.COMPONENT_NAME
ORDER BY SUM(aut.block_csize) DESC
;

--3028124194	BPEL1
--19592854547	BPEL2
--4525779238	BPEL3
--4515855487	BPEL4
--3610041499	BPEL5
--1597028666	BPEL6
--744131108		BPEL7
--726640737		BPEL8
--357352457		BPEL9
